---
tags:
  - oop
---
Объединение `union` представляет собой [[Структуры|структуру]] в которой все члены располагаются по одному и тому же аддресу.

Так, `union` занимает столько же памяти, сколько его наибольший член.

Язык не отслеживает, какие данные хранятся в `union`, так что это должен сделать программист. 

```cpp
enum Type {ptr, num};

union Value {
	Node* p;
	int i;
};

struct Entry {
	string name;
	Type t;
	Value v;
};

void f(Entry* pe) {
	if (pe->t == num) {
		cout << pe->v.i;
	}
	///...
}

```

[[Перечисления]]

Маркированное объединение - это представление на уровне абстракции объединения и текущего типа, которое хранится в объединении.

Лучше всего использовать `union` как *маркированные объединения*. Использование же *голых* объединений лучше свести к минимуму. 

> [!tip]
> - Избегайте *голых* объединений. Заворачивайте их в [[Классы]] вместе с полем типа.

Тип стандартной библиотеки `variant` может использоваться для устранения большинства прямых ошибок. Внутри уже заложена необходимая абстракция.

```cpp

struct Entry {
	string name;
	variant<Node*, int> v;
};

void f(Entry* pe) {
	if (holds_alternative<int>(pe->v)) {
		cout << pe->v.i;
	}
	///...
}

```

Для множества применений `variant` проще и безопаснее, чем `union`

[[!Язык программирования C++. Краткий курс|Источник]]

